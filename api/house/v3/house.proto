syntax = "proto3";

package api.house.v3;
import "google/api/annotations.proto";
option go_package = "anjuke/api/house/v3;v3";
option java_multiple_files = true;
option java_package = "api.house.v3";
option java_outer_classname = "HouseProtoV3";

service House {
	rpc CreateHouse (CreateHouseRequest) returns (CreateHouseReply){
		option (google.api.http) = {
			post: "/house/create"
			body:"*"
		};
	};
	// 点赞房源
	rpc LikeProperty (LikePropertyRequest) returns (LikePropertyReply){
		option (google.api.http) = {
			post: "/house/{property_id}/like"
			body:"*"
		};
	};

	// 取消点赞房源
	rpc UnlikeProperty (UnlikePropertyRequest) returns (UnlikePropertyReply){
		option (google.api.http) = {
			post: "/house/{property_id}/unlike"
			body:"*"
		};
	};

	// 检查用户是否已点赞
	rpc IsPropertyLiked (IsPropertyLikedRequest) returns (IsPropertyLikedReply){
		option (google.api.http) = {
			get: "/house/{property_id}/like/status"
			additional_bindings {
				get: "/house/{property_id}/like/status/{user_id}"
			}
		};
	};

	// 获取房源点赞数
	rpc GetPropertyLikeCount (GetPropertyLikeCountRequest) returns (GetPropertyLikeCountReply){
		option (google.api.http) = {
			get: "/house/{property_id}/like/count"
		};
	};

	// 获取用户点赞列表
	rpc GetUserLikeList (GetUserLikeListRequest) returns (GetUserLikeListReply){
		option (google.api.http) = {
			get: "/house/user/{user_id}/like/list"
		};
	};
}

message CreateHouseRequest {}
message CreateHouseReply {}

// 点赞房源请求
message LikePropertyRequest {
	int64 property_id = 1; // 房源ID
	int64 user_id = 2;     // 用户ID
}

// 点赞房源响应
message LikePropertyReply {
	bool success = 1;      // 是否成功
	string message = 2;    // 提示信息
	int64 like_count = 3;  // 当前点赞数
}

// 取消点赞房源请求
message UnlikePropertyRequest {
	int64 property_id = 1; // 房源ID
	int64 user_id = 2;     // 用户ID
}

// 取消点赞房源响应
message UnlikePropertyReply {
	bool success = 1;      // 是否成功
	string message = 2;    // 提示信息
	int64 like_count = 3;  // 当前点赞数
}

// 检查用户是否已点赞请求
message IsPropertyLikedRequest {
	int64 property_id = 1; // 房源ID
	int64 user_id = 2;     // 用户ID
}

// 检查用户是否已点赞响应
message IsPropertyLikedReply {
	bool liked = 1;        // 是否已点赞
	int64 like_count = 2;  // 当前点赞数
}

// 获取房源点赞数请求
message GetPropertyLikeCountRequest {
	int64 property_id = 1; // 房源ID
}

// 获取房源点赞数响应
message GetPropertyLikeCountReply {
	int64 count = 1;       // 点赞总数
}

// 获取用户点赞列表请求
message GetUserLikeListRequest {
	int64 user_id = 1;     // 用户ID
	int32 page = 2;        // 页码，从1开始
	int32 page_size = 3;   // 每页数量
}

// 获取用户点赞列表响应
message GetUserLikeListReply {
	repeated PropertyLike properties = 1;  // 点赞的房源列表
	int64 total_count = 2;                 // 总数量
	int32 page = 3;                        // 当前页码
	int32 page_size = 4;                   // 每页数量
}

// 点赞的房源信息
message PropertyLike {
	int64 id = 1;          // 点赞ID
	int64 property_id = 2; // 房源ID
	int64 user_id = 3;     // 用户ID
	int64 created_at = 4;  // 点赞时间戳
	string property_title = 5; // 房源标题
	string property_image = 6; // 房源图片
	double property_price = 7; // 房源价格
}